# 🌐 Transtation 中文字符串提取工具 v2.0

这是一个专门为 Kotlin Multiplatform 项目设计的中文字符串国际化工具，可以自动提取代码中的中文字符串，通过 AI 翻译成英文，并自动生成 LibRes 格式的资源文件。

## ✨ v2.0 新特性

### 🔧 高级配置
- **模型选择**：支持 GPT-4o、GPT-4o Mini、GPT-4 Turbo、GPT-3.5 Turbo
- **批次控制**：可配置每次翻译的字符串数量（1-50条）
- **自定义提示**：支持添加自定义翻译提示，提高翻译质量

### 🎯 智能选择
- **点击选择**：点击整个字符串条目即可选择/取消选择
- **多选支持**：按住 Ctrl/Cmd 键可进行多选
- **拖拽选择**：按住鼠标拖拽可连续选择多个条目
- **选择记忆**：翻译失败后保持用户的选择状态，不会重置

### 🎨 界面优化
- **可展开配置**：高级配置默认折叠，需要时点击展开
- **视觉反馈**：选中的条目有明显的视觉标识
- **拖拽提示**：拖拽选择时显示操作提示

## 🚀 快速开始

### 1. 启动工具
```bash
# Windows
双击 start.bat

# 或手动启动
python chinese_string_extractor.py
```

### 2. 配置项目
1. **基础配置**：
   - 输入项目根目录路径
   - 设置 OpenAI API Key
   - 设置 API Base URL（可选）

2. **高级配置**（点击展开）：
   - 选择翻译模型（推荐 GPT-4o Mini）
   - 设置批次大小（建议 5-20）
   - 添加自定义翻译提示

### 3. 选择字符串
- **全选/反选**：使用控制按钮快速选择
- **单击选择**：点击条目进行单选
- **多选**：按住 Ctrl/Cmd 点击多个条目
- **拖拽选择**：按住鼠标拖拽选择连续区域

### 4. 翻译和编辑
- 点击"翻译选中项"开始翻译
- 在结果中手动编辑资源名称和翻译
- 确认无误后点击"保存更改"

## 📋 使用技巧

### 模型选择建议
- **GPT-4o Mini**：推荐，性价比高，质量好
- **GPT-4o**：最高质量，成本较高
- **GPT-4 Turbo**：平衡选择
- **GPT-3.5 Turbo**：成本最低，质量一般

### 批次大小建议
- **5-10条**：适合复杂文本，翻译质量更高
- **10-20条**：常规推荐，平衡效率和质量
- **20条以上**：适合简单文本，提高效率

### 自定义提示示例
```
请使用正式的软件界面语言风格翻译，避免口语化表达。
对于错误信息，使用清晰简洁的描述。
对于按钮文本，使用动词形式。
```

## 🎯 选择操作说明

### 基础操作
- **单击条目**：选择/取消选择该条目，同时取消其他选择
- **Ctrl+单击**：添加/移除该条目到选择中，保持其他选择不变
- **全选按钮**：选中所有条目
- **取消全选**：取消所有选择
- **选择未翻译**：只选择还没有翻译的条目

### 拖拽选择
1. 在条目上按住鼠标左键开始拖拽
2. 拖拽到目标条目释放鼠标
3. 拖拽范围内的所有条目将被选中

### 选择状态保持
- 翻译成功后：保持用户的选择状态
- 翻译失败后：恢复到翻译前的选择状态
- 不会因为操作失败而意外改变用户的选择

## 🔧 高级功能

### 批量翻译优化
- 自动将大批量请求分割成小批次
- 每个批次独立处理，提高成功率
- 失败的批次不影响其他批次

### 智能提示合并
- 基础翻译提示 + 用户自定义提示
- 保持提示的一致性和完整性

### 错误处理
- 网络错误自动重试机制
- JSON 解析失败时的智能修复
- 详细的错误信息提示

## 🎨 界面特色

### 视觉反馈
- 选中条目：蓝色背景 + 左侧蓝色边框
- 拖拽预览：浅蓝色背景提示
- 鼠标悬停：浅灰色背景

### 响应式设计
- 支持桌面和移动设备
- 自适应布局
- 触摸友好的交互

## 📂 文件结构

```
resource-extractor/
├── chinese_string_extractor.py  # 主程序
├── helper.py                   # 核心功能类
├── static/
│   └── index.html             # Web界面
├── start.bat                  # Windows启动脚本
└── README.md                  # 本文件
```

## 🐛 故障排除

### 翻译失败
1. 检查 API Key 是否正确
2. 检查网络连接
3. 尝试减少批次大小
4. 检查模型是否可用

### 选择不响应
1. 确保点击的是条目区域，不是输入框
2. 检查是否在拖拽模式中
3. 刷新页面重新开始

### 界面显示异常
1. 检查浏览器版本
2. 清除浏览器缓存
3. 尝试其他浏览器

## 📄 版本历史

### v2.0 (当前版本)
- ✅ 高级配置支持
- ✅ 智能选择交互
- ✅ 拖拽选择功能
- ✅ 选择状态保持
- ✅ 批量处理优化

### v1.0
- ✅ 基础字符串提取
- ✅ AI 翻译功能
- ✅ XML 文件生成
- ✅ 代码自动替换

---

**注意事项**：
- 首次使用前请备份代码
- 翻译结果需要人工审核
- 注意 API 使用费用
- 保护好 API Key 安全